(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[673],{76418:function(e,t,a){Promise.resolve().then(a.bind(a,89771))},89771:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return page}});var n=a(57437),r=a(90500),i=a(2265),s=a(88938),o=a(49050),l=a(20879),d=a(96507),c=a(73701),u=a(39279),h=a(30666),p=a(15795),g=a(19464),m=a(98489),x=a(34989),f=a(43226),j=a(29872),Z=a(40182),b=a(14647),D=a(92750),v=a(74124),P=a(76722),Y=a(74548),C=a.n(Y),y=a(28874),S=a(50898),M=a(66988),R=a(95781),k=a(92226),inventarios_enhancedTableHead=e=>{let{order:t,orderBy:a,onRequestSort:r}=e,createSortHandler=e=>t=>{r(t,e)};return(0,n.jsx)(M.Z,{children:(0,n.jsx)(m.Z,{children:[{id:"name",numeric:!1,disablePadding:!0,label:"Producto"},{id:"quantity",numeric:!0,disablePadding:!1,label:"Cantidad Adquirida"},{id:"amount",numeric:!0,disablePadding:!1,label:"Cantidad Vendida"},{id:"buyDate",numeric:!0,disablePadding:!1,label:"Fecha de Recepcion"},{id:"stock",numeric:!0,disablePadding:!1,label:"Cantidad Actual"}].map(e=>(0,n.jsx)(h.Z,{align:e.numeric?"right":"left",padding:"normal",sortDirection:a===e.id&&t,children:(0,n.jsxs)(R.Z,{active:a===e.id,direction:a===e.id?t:"asc",onClick:createSortHandler(e.id),children:[e.label,a===e.id?(0,n.jsx)(d.Z,{component:"span",sx:k.Z,children:"desc"===t?"sorted descending":"sorted ascending"}):null]})},e.id))})})},w=a(31601),page=()=>{let[e,t]=(0,i.useState)("desc"),[a,Y]=(0,i.useState)("name"),[M,R]=(0,i.useState)(0),[k,F]=(0,i.useState)(!1),[_,A]=(0,i.useState)(10),[q,T]=(0,i.useState)(C()().subtract(1,"month").format("YYYY-MM-DD")),[N,z]=(0,i.useState)(C()().format("YYYY-MM-DD")),[E,O]=(0,i.useState)([]),[H,I]=(0,i.useState)([]);(0,i.useEffect)(()=>{getData()},[]);let getData=async()=>{let e=await r.Z.get(w.b.inventaryReportData+q+"/"+N);if(200==e.status){let t=await e.data;I(t=processData(t)),O(t)}},generateReport=()=>{getData()},handleDateChange=(e,t)=>{e=C()(e).format("YYYY-MM-DD"),"start"===t?T(e):z(e)},processData=e=>{let t=[];return e.map(e=>{let a=0,n=0,r="none";e.inventories.map(e=>{n+=e.buying_amount,r=e.buying_date}),e.selection_details.map(e=>{a+=e.quantity}),r="none"==r?"":C()(r).format("DD-MM-YYYY"),t.push(getProductJSON(e.id,e.name,a,n,r,e.stock))}),t},getProductJSON=(e,t,a,n,r,i)=>({id:e,name:t,quantity:a,amount:n,buyDate:r,stock:i}),productSearch=e=>{O(""===e?H:H.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())))},Q=(0,i.useMemo)(()=>(function(e,t){let a=e.map((e,t)=>[e,t]);return a.sort((e,a)=>{let n=t(e[0],a[0]);return 0!==n?n:e[1]-a[1]}),a.map(e=>e[0])})(E,"desc"===e?(e,t)=>descendingComparator(e,t,a):(e,t)=>-descendingComparator(e,t,a)).slice(M*_,M*_+_),[E,e,a,M,_]),V=M>0?Math.max(0,(1+M)*_-E.length):0;function descendingComparator(e,t,a){return t[a]<e[a]?1:t[a]>e[a]?-1:0}return(0,n.jsx)(s.Z,{style:{marginTop:"10vh"},children:(0,n.jsxs)(d.Z,{sx:{width:"100%"},children:[(0,n.jsxs)(j.Z,{sx:{width:"100%",mb:2},children:[(0,n.jsx)(f.Z,{sx:{flex:"1 1 100%",p:2},variant:"h5",id:"tableTitle",component:"div",children:"Informe de Inventarios"}),(0,n.jsx)(x.Z,{children:(0,n.jsxs)(y.ZP,{container:!0,spacing:2,children:[(0,n.jsxs)(v._,{dateAdapter:D.y,children:[(0,n.jsx)(y.ZP,{item:!0,xs:2,children:(0,n.jsx)(P.M,{format:"DD/MM/YYYY",defaultValue:C()(q),maxDate:C()(N),onChange:e=>handleDateChange(e,"start"),slotProps:{textField:{size:"small",helperText:"Fecha inicio"}}})}),(0,n.jsx)(y.ZP,{item:!0,xs:2,children:(0,n.jsx)(P.M,{format:"DD/MM/YYYY",defaultValue:C()(N),minDate:C()(q),onChange:e=>handleDateChange(e,"end"),slotProps:{textField:{size:"small",helperText:"Fecha fin"}}})})]}),(0,n.jsx)(y.ZP,{item:!0,xs:2,children:(0,n.jsx)(o.Z,{variant:"outlined",onClick:e=>generateReport(),children:"Generar"})}),(0,n.jsx)(y.ZP,{item:!0,xs:6,children:(0,n.jsx)(l.Z,{sx:{width:"100%"},id:"productSearch",label:"Buscar producto...",variant:"outlined",size:"small",onKeyUp:e=>productSearch(e.target.value)})})]})}),(0,n.jsx)(p.Z,{children:(0,n.jsxs)(c.Z,{sx:{minWidth:750},"aria-labelledby":"tableTitle",size:k?"small":"medium",stickyHeader:!0,children:[(0,n.jsx)(inventarios_enhancedTableHead,{order:e,orderBy:a,onRequestSort:(n,r)=>{let i=a===r&&"asc"===e;t(i?"desc":"asc"),Y(r)}}),(0,n.jsxs)(u.Z,{children:[Q.map((e,t)=>(0,n.jsxs)(m.Z,{hover:!0,tabIndex:-1,children:[(0,n.jsx)(h.Z,{align:"left",children:e.name}),(0,n.jsx)(h.Z,{align:"right",children:e.amount}),(0,n.jsx)(h.Z,{align:"right",children:e.quantity}),(0,n.jsx)(h.Z,{align:"right",children:e.buyDate}),(0,n.jsx)(h.Z,{align:"right",children:e.stock})]},e.id)),V>0&&(0,n.jsx)(m.Z,{style:{height:(k?33:53)*V},children:(0,n.jsx)(h.Z,{colSpan:6})})]})]})}),(0,n.jsx)(g.Z,{rowsPerPageOptions:[5,10,25],component:"div",count:E.length,rowsPerPage:_,page:M,onPageChange:(e,t)=>{R(t)},onRowsPerPageChange:e=>{A(parseInt(e.target.value,10)),R(0)},labelRowsPerPage:"Productos por pagina"})]}),(0,n.jsxs)(d.Z,{sx:{width:"100%"},children:[(0,n.jsx)(Z.Z,{control:(0,n.jsx)(b.Z,{checked:k,onChange:e=>{F(e.target.checked)}}),label:"Espaciado de filas denso",style:{width:"88%"}}),(0,n.jsx)(o.Z,{variant:"outlined",onClick:()=>{let e=[{name:"Fecha inicio",value:q},{name:"Fecha fin",value:N}];(0,S.Z)({title:"Reporte de inventarios",fileName:"reporte_inventarios"},e,["Producto","Cant. Adquirida","Cant. Vendida","Fecha de Recepcion","Cant. Actual"],E)},children:"Generar PDF"})]})]})})}},50898:function(e,t,a){"use strict";var n=a(60930);a(59567),t.Z=(e,t,a,r)=>{let i=new n.default,s=[];r.forEach(e=>{let t=Object.values(e);t=t.slice(1),s.push(t)});let o=15,l=15;i.text("UrbanMarket - "+e.title,l,o),o+=12,i.setFontSize(12),t.map(e=>{i.text(e.name+": "+e.value,l,o),l>145?(l=15,o+=10):l+=65}),o+=10,i.autoTable(a,s,{startY:o}),i.save(e.fileName+".pdf")}},90500:function(e,t,a){"use strict";var n=a(92173);let r=n.Z.create({baseURL:"http://localhost:8000/api"});r.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&e.headers&&(e.headers.Authorization=t?"Bearer ".concat(t):""),e},e=>Promise.reject(e)),r.interceptors.response.use(e=>e,e=>Promise.reject(e)),t.Z=r},31601:function(e,t,a){"use strict";a.d(t,{b:function(){return n}});let n={hello:"/hello",user:"/user",profile:"/profile",logout:"/logout",profile:"/profile",reports:"/reportes",clientReportData:"/reporting/user/",userReportData:"/reporting/user-register/",userDelete:"/reporting/user/",inventaryReport:"/reportes/inventarios",inventaryReportData:"/reporting/inventary/",saleReportData:"/reporting/sale/",login:"/login",logout:"/logout",addFAQ:"/agregar-pregunta",editFAQ:"/editar-pregunta/",deleteFAQ:"/",FAQS:"/faqs",ordersYear:"reporting/ordersYears",economicReport:"reporting/economicReport"}}},function(e){e.O(0,[505,226,886,429,997,173,711,874,479,735,133,84,368,971,472,744],function(){return e(e.s=76418)}),_N_E=e.O()}]);